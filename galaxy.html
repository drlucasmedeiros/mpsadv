<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYNTA ‚Ä¢ Conex√µes Globais por C√≥digo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <script src="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@geoapify/geocoder-autocomplete@1.4.0/dist/autocomplete.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@geoapify/geocoder-autocomplete@1.4.0/styles/minimal.css" />
    <style>
        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --primary-light: #a78bfa;
            --secondary: #d946ef;
            --secondary-dark: #c026d3;
            --accent: #f0abfc;
            --accent-alt: #f59e0b;
            --light: #f8fafc;
            --dark: #0f172a;
            --dark-purple: #1e1b4b;
            --space-black: #0a0a1a;
            --galaxy-purple: #4c1d95;
            --neon-purple: #a855f7;
            --gray: #94a3b8;
            --light-gray: #334155;
            --card-bg: rgba(30, 27, 75, 0.85);
            --glass-bg: rgba(139, 92, 246, 0.15);
            --glass-border: rgba(168, 85, 247, 0.3);
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            --glow: 0 0 20px rgba(168, 85, 247, 0.4);
            --radius: 16px;
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            --star-size: 2px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1e1b4b 50%, #4c1d95 100%);
            color: var(--light);
            line-height: 1.6;
            overflow: hidden;
            height: 100vh;
            position: relative;
        }
        
        /* Galaxy background with stars */
        .galaxy-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(ellipse at 20% 30%, rgba(139, 92, 246, 0.1) 0%, transparent 40%),
                radial-gradient(ellipse at 80% 70%, rgba(217, 70, 239, 0.1) 0%, transparent 40%),
                radial-gradient(ellipse at 50% 50%, rgba(139, 92, 246, 0.05) 0%, transparent 60%);
        }
        
        /* Animated stars */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle var(--twinkle-duration) infinite alternate;
        }
        
        @keyframes twinkle {
            0% { opacity: 0.2; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        /* Nebula effect */
        .nebula {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 10% 20%, rgba(139, 92, 246, 0.2) 0%, transparent 30%),
                radial-gradient(circle at 90% 40%, rgba(217, 70, 239, 0.2) 0%, transparent 30%),
                radial-gradient(circle at 40% 80%, rgba(168, 85, 247, 0.15) 0%, transparent 40%);
            filter: blur(40px);
            opacity: 0.6;
        }
        
        .app-container {
            display: flex;
            height: 100vh;
            width: 100vw;
            position: relative;
        }
        
        /* Globe Container */
        .globe-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        #globeCanvas {
            width: 100%;
            height: 100%;
            display: block;
            filter: drop-shadow(0 0 20px rgba(168, 85, 247, 0.3));
        }
        
        .globe-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .globe-title {
            position: absolute;
            top: 24px;
            left: 24px;
            color: white;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 0 0 20px rgba(168, 85, 247, 0.8), 0 2px 10px rgba(0, 0, 0, 0.5);
            pointer-events: auto;
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(30, 27, 75, 0.6);
            padding: 12px 24px;
            border-radius: var(--radius);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow), var(--glow);
        }
        
        .globe-title i {
            color: var(--accent);
            filter: drop-shadow(0 0 10px rgba(240, 171, 252, 0.8));
        }
        
        .globe-controls {
            position: absolute;
            bottom: 24px;
            left: 24px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            pointer-events: auto;
        }
        
        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-size: 1.3rem;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow), var(--glow);
        }
        
        .control-btn:hover, .control-btn.active {
            background: var(--primary);
            transform: translateY(-5px) scale(1.1);
            color: white;
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.5);
        }
        
        .globe-stats {
            position: absolute;
            top: 24px;
            right: 24px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            padding: 20px 30px;
            color: white;
            pointer-events: auto;
            box-shadow: var(--shadow), var(--glow);
            min-width: 220px;
        }
        
        .stats-title {
            font-size: 0.9rem;
            color: var(--accent);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stats-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: white;
            font-family: 'Space Grotesk', sans-serif;
            background: linear-gradient(135deg, var(--primary-light), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
        }
        
        .location-info {
            position: absolute;
            bottom: 24px;
            right: 24px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            padding: 20px;
            color: white;
            pointer-events: auto;
            box-shadow: var(--shadow), var(--glow);
            max-width: 320px;
            opacity: 0;
            transform: translateY(10px) scale(0.95);
            transition: var(--transition);
            z-index: 2;
        }
        
        .location-info.active {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        
        .location-name {
            font-weight: 700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            color: var(--accent);
        }
        
        .location-posts {
            font-size: 1rem;
            color: var(--gray);
        }
        
        /* Connection lines */
        .connection-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, var(--primary), transparent);
            transform-origin: 0 0;
            pointer-events: none;
            z-index: 0;
        }
        
        /* Side Panel */
        .side-panel {
            width: 420px;
            background: var(--card-bg);
            border-left: 1px solid var(--glass-border);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: -10px 0 40px rgba(0, 0, 0, 0.4), -5px 0 20px rgba(168, 85, 247, 0.2);
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10;
        }
        
        .side-panel.collapsed {
            transform: translateX(100%);
        }
        
        .panel-toggle {
            position: absolute;
            top: 24px;
            right: 444px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-size: 1.3rem;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow), var(--glow);
            z-index: 10;
        }
        
        .panel-toggle:hover {
            background: var(--primary);
            transform: translateX(-5px) scale(1.1);
            color: white;
        }
        
        .panel-toggle.collapsed {
            right: 24px;
        }
        
        .panel-header {
            padding: 24px;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(30, 27, 75, 0.9);
        }
        
        .panel-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.6rem;
            font-weight: 700;
            color: white;
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }
        
        .panel-close {
            background: none;
            border: none;
            font-size: 1.3rem;
            color: var(--accent);
            cursor: pointer;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .panel-close:hover {
            background: rgba(168, 85, 247, 0.2);
            color: white;
            transform: rotate(90deg);
        }
        
        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }
        
        /* Custom scrollbar */
        .panel-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .panel-content::-webkit-scrollbar-track {
            background: rgba(30, 27, 75, 0.3);
            border-radius: 4px;
        }
        
        .panel-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        .panel-section {
            margin-bottom: 32px;
        }
        
        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--glass-border);
        }
        
        .section-title i {
            color: var(--primary);
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 24px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
            color: white;
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 14px 18px;
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            font-family: inherit;
            font-size: 1rem;
            transition: var(--transition);
            background: rgba(30, 27, 75, 0.6);
            color: white;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2), var(--glow);
        }
        
        .form-hint {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 8px;
        }
        
        .btn {
            padding: 14px 28px;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 20px rgba(139, 92, 246, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(139, 92, 246, 0.6);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--accent);
            border: 2px solid var(--primary);
        }
        
        .btn-outline:hover {
            background: rgba(139, 92, 246, 0.1);
            transform: translateY(-2px);
        }
        
        .btn-small {
            padding: 10px 20px;
            font-size: 0.9rem;
        }
        
        /* Posts List */
        .posts-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .post-card {
            background: rgba(30, 27, 75, 0.7);
            border-radius: var(--radius);
            padding: 24px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: var(--transition);
            border: 1px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .post-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3), var(--glow);
            border-color: var(--glass-border);
        }
        
        .post-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), transparent);
            z-index: -1;
        }
        
        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }
        
        .post-category {
            display: inline-block;
            padding: 6px 16px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .post-time {
            font-size: 0.9rem;
            color: var(--accent);
        }
        
        .post-title {
            font-weight: 700;
            margin-bottom: 12px;
            line-height: 1.4;
            font-size: 1.2rem;
            color: white;
        }
        
        .post-description {
            color: var(--gray);
            font-size: 1rem;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .post-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 20px;
            border-top: 1px solid var(--glass-border);
        }
        
        .post-location {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            color: var(--accent);
        }
        
        .post-actions {
            display: flex;
            gap: 10px;
        }
        
        /* Dashboard Styles */
        .dashboard-section {
            background: rgba(30, 27, 75, 0.7);
            border-radius: var(--radius);
            padding: 28px;
            margin-bottom: 28px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid transparent;
            transition: var(--transition);
        }
        
        .dashboard-section:hover {
            border-color: var(--glass-border);
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .user-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 1.8rem;
            box-shadow: var(--shadow), var(--glow);
        }
        
        .user-info h3 {
            font-weight: 700;
            margin-bottom: 6px;
            font-size: 1.4rem;
        }
        
        .user-info p {
            color: var(--gray);
            font-size: 1rem;
        }
        
        .code-display {
            background: rgba(30, 27, 75, 0.9);
            border-radius: var(--radius);
            padding: 20px;
            font-family: monospace;
            font-size: 1.4rem;
            letter-spacing: 3px;
            text-align: center;
            margin: 24px 0;
            border: 2px solid var(--glass-border);
            color: var(--accent);
            font-weight: 700;
            box-shadow: var(--shadow);
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 24px;
        }
        
        .stat-card {
            background: rgba(30, 27, 75, 0.8);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            border: 1px solid var(--glass-border);
            transition: var(--transition);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: white;
            font-family: 'Space Grotesk', sans-serif;
            margin-bottom: 5px;
            background: linear-gradient(135deg, var(--primary-light), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        /* Messages */
        .messages-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
            max-height: 300px;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .message-item {
            display: flex;
            gap: 16px;
            padding: 20px;
            background: rgba(30, 27, 75, 0.6);
            border-radius: var(--radius);
            border: 1px solid var(--glass-border);
            transition: var(--transition);
            cursor: pointer;
        }
        
        .message-item:hover {
            background: rgba(30, 27, 75, 0.9);
            transform: translateX(5px);
        }
        
        .message-item.unread {
            border-left: 4px solid var(--primary);
        }
        
        .message-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        .message-content {
            flex: 1;
        }
        
        .message-sender {
            font-weight: 700;
            margin-bottom: 6px;
            color: white;
        }
        
        .message-preview {
            font-size: 0.95rem;
            color: var(--gray);
            line-height: 1.4;
        }
        
        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 26, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--card-bg);
            border-radius: var(--radius);
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5), var(--glow);
            animation: modalAppear 0.4s ease;
            border: 1px solid var(--glass-border);
        }
        
        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .modal-header {
            padding: 28px;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(30, 27, 75, 0.9);
        }
        
        .modal-header h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
        }
        
        .modal-body {
            padding: 28px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 2rem;
            color: var(--accent);
            cursor: pointer;
            transition: var(--transition);
            line-height: 1;
        }
        
        .close-modal:hover {
            color: white;
            transform: rotate(90deg);
        }
        
        /* Notification */
        .notification {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 20px 24px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3), var(--glow);
            display: flex;
            align-items: center;
            gap: 16px;
            transform: translateX(100px);
            opacity: 0;
            transition: var(--transition);
            z-index: 1001;
            max-width: 400px;
            border-left: 4px solid var(--primary);
            border: 1px solid var(--glass-border);
        }
        
        .notification.active {
            transform: translateX(0);
            opacity: 1;
        }
        
        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 1.2rem;
        }
        
        /* Loading */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 40px;
            color: var(--gray);
            text-align: center;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--glass-border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Geoapify Autocomplete Customization */
        .geoapify-autocomplete-input {
            background: rgba(30, 27, 75, 0.6) !important;
            border: 1px solid var(--glass-border) !important;
            color: white !important;
            padding: 14px 18px !important;
            border-radius: var(--radius) !important;
            font-family: 'Inter', sans-serif !important;
        }
        
        .geoapify-autocomplete-items {
            background: var(--card-bg) !important;
            border: 1px solid var(--glass-border) !important;
            border-radius: var(--radius) !important;
            margin-top: 5px !important;
        }
        
        .geoapify-autocomplete-item {
            color: white !important;
            padding: 12px 18px !important;
        }
        
        .geoapify-autocomplete-item:hover {
            background: rgba(139, 92, 246, 0.2) !important;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .side-panel {
                width: 100%;
                max-width: 450px;
                position: fixed;
                right: 0;
                top: 0;
                height: 100vh;
                z-index: 100;
            }
            
            .panel-toggle {
                right: calc(100% - 44px);
            }
            
            .panel-toggle.collapsed {
                right: 24px;
            }
        }
        
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .globe-container {
                height: 60vh;
            }
            
            .side-panel {
                height: 40vh;
                max-width: 100%;
                position: fixed;
                bottom: 0;
                top: auto;
                border-left: none;
                border-top: 1px solid var(--glass-border);
                transform: translateY(100%);
            }
            
            .side-panel:not(.collapsed) {
                transform: translateY(0);
            }
            
            .panel-toggle {
                top: auto;
                bottom: 24px;
                right: 24px;
            }
            
            .panel-toggle.collapsed {
                transform: rotate(180deg);
            }
            
            .globe-title {
                font-size: 1.4rem;
                padding: 10px 16px;
            }
            
            .globe-stats, .location-info {
                position: relative;
                top: auto;
                right: auto;
                margin: 16px;
                width: calc(100% - 32px);
            }
            
            .globe-controls {
                flex-direction: row;
                bottom: 16px;
                left: 50%;
                transform: translateX(-50%);
            }
            
            .modal-content {
                margin: 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .globe-title {
                font-size: 1.2rem;
            }
            
            .panel-content {
                padding: 16px;
            }
            
            .dashboard-section {
                padding: 20px;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 0.9rem;
            }
        }
        
        /* Pulse animation for active markers */
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Connection animation */
        @keyframes connect {
            0% { width: 0%; opacity: 0; }
            100% { width: 100%; opacity: 1; }
        }
        
        /* Floating animation */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .floating {
            animation: float 3s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <!-- Galaxy Background Elements -->
    <div class="galaxy-bg"></div>
    <div class="nebula"></div>
    <div class="stars" id="starsContainer"></div>
    
    <div class="app-container">
        <!-- Globe Section -->
        <div class="globe-container">
            <canvas id="globeCanvas"></canvas>
            
            <div class="globe-overlay">
                <div class="globe-title floating">
                    <i class="fas fa-globe-americas"></i>
                    <span>SYNTA ‚Ä¢ GALAXY</span>
                </div>
                
                <div class="globe-controls">
                    <button class="control-btn" id="zoomInBtn">
                        <i class="fas fa-search-plus"></i>
                    </button>
                    <button class="control-btn" id="zoomOutBtn">
                        <i class="fas fa-search-minus"></i>
                    </button>
                    <button class="control-btn" id="resetViewBtn">
                        <i class="fas fa-home"></i>
                    </button>
                    <button class="control-btn active" id="autoRotateBtn">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <button class="control-btn" id="nightModeBtn">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
                
                <div class="globe-stats">
                    <div class="stats-title">Conex√µes Ativas</div>
                    <div class="stats-value" id="totalPosts">1,247</div>
                </div>
                
                <div class="location-info" id="locationInfo">
                    <div class="location-name">
                        <i class="fas fa-map-marker-alt"></i>
                        <span id="locationName">Selecione um local</span>
                    </div>
                    <div class="location-posts" id="locationPostsCount">0 conex√µes nesta regi√£o</div>
                    <div id="locationDetails" style="margin-top: 10px; font-size: 0.9rem; color: var(--accent);"></div>
                </div>
            </div>
        </div>
        
        <!-- Panel Toggle -->
        <button class="panel-toggle" id="panelToggle">
            <i class="fas fa-chevron-left"></i>
        </button>
        
        <!-- Side Panel -->
        <div class="side-panel" id="sidePanel">
            <div class="panel-header">
                <div class="panel-title" id="panelTitle">üåå Explorar Conex√µes</div>
                <button class="panel-close" id="panelClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="panel-content">
                <!-- Posts View -->
                <div id="postsView">
                    <div class="panel-section">
                        <h3 class="section-title">
                            <i class="fas fa-filter"></i>
                            Filtros Galaxy
                        </h3>
                        <div class="form-group">
                            <select class="form-control" id="categoryFilter">
                                <option value="all">üå† Todas as categorias</option>
                                <option value="friendship">üë• Amizade</option>
                                <option value="business">üíº Neg√≥cios</option>
                                <option value="services">üîß Servi√ßos</option>
                                <option value="events">üéâ Eventos</option>
                                <option value="ideas">üí° Ideias</option>
                                <option value="learning">üìö Aprendizado</option>
                                <option value="collab">ü§ù Colabora√ß√£o</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="searchFilter" placeholder="üîç Buscar conex√µes...">
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" id="locationFilter" placeholder="üìç Filtrar por cidade/pa√≠s">
                        </div>
                    </div>
                    
                    <div class="panel-section">
                        <h3 class="section-title">
                            <i class="fas fa-bullhorn"></i>
                            Conex√µes Recentes
                        </h3>
                        <div class="posts-list" id="postsList">
                            <!-- Posts will be loaded here -->
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <button class="btn btn-primary" id="createPostBtn" style="width: 100%;">
                            <i class="fas fa-plus-circle"></i> Nova Conex√£o Galaxy
                        </button>
                    </div>
                    
                    <div class="form-group" style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-outline btn-small" id="accessAccountBtn">
                            <i class="fas fa-key"></i> Acessar Minha Gal√°xia
                        </button>
                    </div>
                </div>
                
                <!-- Dashboard View (Hidden by default) -->
                <div id="dashboardView" style="display: none;">
                    <div class="dashboard-section">
                        <div class="user-profile">
                            <div class="user-avatar" id="userAvatar">JS</div>
                            <div class="user-info">
                                <h3 id="userName">Viajante Galaxy</h3>
                                <p id="userEmail">conexao@galaxy.com</p>
                                <p style="color: var(--accent); font-size: 0.9rem; margin-top: 5px;">
                                    <i class="fas fa-rocket"></i> N√≠vel 3 ‚Ä¢ 1200 pontos
                                </p>
                            </div>
                        </div>
                        
                        <div class="code-display" id="userCode">SYNTA-5A8B3C</div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="userPostsCount">3</div>
                                <div class="stat-label">Conex√µes Ativas</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="userMessagesCount">5</div>
                                <div class="stat-label">Mensagens</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="userProposalsCount">2</div>
                                <div class="stat-label">Propostas</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="userResponsesCount">12</div>
                                <div class="stat-label">Respostas</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px; display: flex; gap: 10px;">
                            <button class="btn btn-outline btn-small" id="editProfileBtn" style="flex: 1;">
                                <i class="fas fa-edit"></i> Editar Perfil
                            </button>
                            <button class="btn btn-outline btn-small" id="viewStatsBtn" style="flex: 1;">
                                <i class="fas fa-chart-line"></i> Estat√≠sticas
                            </button>
                        </div>
                    </div>
                    
                    <div class="dashboard-section">
                        <h3 class="section-title">
                            <i class="fas fa-bullhorn"></i>
                            Minhas Conex√µes
                        </h3>
                        <div class="posts-list" id="userPostsList">
                            <!-- User posts will be loaded here -->
                        </div>
                        <button class="btn btn-outline btn-small" id="newPostFromDashboard" style="width: 100%; margin-top: 16px;">
                            <i class="fas fa-plus"></i> Nova Conex√£o
                        </button>
                    </div>
                    
                    <div class="dashboard-section">
                        <h3 class="section-title">
                            <i class="fas fa-envelope"></i>
                            Mensagens Galaxy
                        </h3>
                        <div class="messages-list" id="userMessagesList">
                            <!-- Messages will be loaded here -->
                        </div>
                        <button class="btn btn-outline btn-small" id="viewAllMessages" style="width: 100%; margin-top: 16px;">
                            <i class="fas fa-inbox"></i> Centro de Mensagens
                        </button>
                    </div>
                    
                    <div style="text-align: center; margin-top: 32px; padding-top: 20px; border-top: 1px solid var(--glass-border);">
                        <button class="btn btn-outline" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i> Sair da Gal√°xia
                        </button>
                    </div>
                </div>
                
                <!-- Create Post View (Hidden by default) -->
                <div id="createPostView" style="display: none;">
                    <div class="panel-section">
                        <h3 class="section-title">
                            <i class="fas fa-plus-circle"></i>
                            Nova Conex√£o Galaxy
                        </h3>
                        
                        <form id="postForm">
                            <div class="form-group">
                                <label class="form-label">T√≠tulo da Conex√£o *</label>
                                <input type="text" class="form-control" id="postTitle" placeholder="Ex: Procuro parceiro para startup de tecnologia" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Categoria Galaxy *</label>
                                <select class="form-control" id="postCategory" required>
                                    <option value="">üåå Selecione uma categoria</option>
                                    <option value="friendship">üë• Amizade & Networking</option>
                                    <option value="business">üíº Neg√≥cios & Parcerias</option>
                                    <option value="services">üîß Servi√ßos & Habilidades</option>
                                    <option value="events">üéâ Eventos & Encontros</option>
                                    <option value="ideas">üí° Ideias & Projetos</option>
                                    <option value="learning">üìö Aprendizado & Mentoria</option>
                                    <option value="collab">ü§ù Colabora√ß√£o & Co-cria√ß√£o</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Descri√ß√£o da Conex√£o *</label>
                                <textarea class="form-control" id="postDescription" rows="4" placeholder="Descreva sua proposta, o que voc√™ busca ou oferece... (m√°x. 500 caracteres)" required maxlength="500"></textarea>
                                <div class="form-hint" id="charCount">0/500 caracteres</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">üìç Localiza√ß√£o (Digite a cidade)</label>
                                <div id="locationAutocomplete"></div>
                                <input type="hidden" id="postLat">
                                <input type="hidden" id="postLng">
                                <input type="hidden" id="postCity">
                                <input type="hidden" id="postCountry">
                                <div class="form-hint">Comece a digitar para ver sugest√µes precisas</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Seu e-mail *</label>
                                <input type="email" class="form-control" id="postEmail" placeholder="seu@email.com" required>
                                <div class="form-hint">Seu e-mail nunca ser√° exibido publicamente</div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Dura√ß√£o da Conex√£o</label>
                                <select class="form-control" id="postDuration">
                                    <option value="7">7 dias (1.200 pontos)</option>
                                    <option value="14">14 dias (2.000 pontos)</option>
                                    <option value="30">30 dias (3.500 pontos)</option>
                                    <option value="90">90 dias (8.000 pontos)</option>
                                </select>
                                <div class="form-hint"><i class="fas fa-gem" style="color: var(--accent-alt);"></i> Use pontos para estender conex√µes</div>
                            </div>
                            
                            <div class="form-group" style="background: rgba(139, 92, 246, 0.1); padding: 15px; border-radius: var(--radius); border: 1px solid var(--glass-border);">
                                <label style="display: flex; align-items: center; gap: 10px; color: var(--accent);">
                                    <i class="fas fa-shield-alt"></i>
                                    <span>Privacidade Galaxy</span>
                                </label>
                                <div style="margin-top: 10px; display: flex; gap: 15px;">
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="privacy" value="public" checked>
                                        <span style="font-size: 0.9rem;">üåç P√∫blica (Recomendada)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                        <input type="radio" name="privacy" value="private">
                                        <span style="font-size: 0.9rem;">üîí Apenas convidados</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary" style="width: 100%;">
                                    <i class="fas fa-paper-plane"></i> Lan√ßar no Galaxy
                                </button>
                            </div>
                        </form>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <button class="btn btn-outline btn-small" id="cancelPostBtn">
                                <i class="fas fa-arrow-left"></i> Voltar para Conex√µes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Access Modal -->
    <div class="modal" id="accessModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üåå Acessar Gal√°xia</h3>
                <button class="close-modal" id="closeAccessModal">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 4rem; color: var(--primary); margin-bottom: 16px;">
                        <i class="fas fa-key"></i>
                    </div>
                    <h3 style="margin-bottom: 8px;">Bem-vindo de volta, Viajante!</h3>
                    <p style="color: var(--gray);">Insira seu c√≥digo galaxy para acessar suas conex√µes</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Seu C√≥digo SYNTA Galaxy</label>
                    <input type="text" class="form-control" id="accessCode" placeholder="SYNTA-XXXXXX" style="text-align: center; font-size: 1.4rem; letter-spacing: 3px; font-weight: 700;">
                    <div class="form-hint">O c√≥digo que voc√™ recebeu ao criar sua primeira conex√£o</div>
                </div>
                
                <div class="form-group">
                    <button class="btn btn-primary" id="submitAccessCode" style="width: 100%;">
                        <i class="fas fa-unlock"></i> Acessar Minha Gal√°xia
                    </button>
                </div>
                
                <div style="text-align: center; margin-top: 32px; padding-top: 24px; border-top: 1px solid var(--glass-border);">
                    <p style="margin-bottom: 16px; color: var(--gray);">Ainda n√£o √© um viajante galaxy?</p>
                    <button class="btn btn-outline" id="createFirstPost">
                        <i class="fas fa-rocket"></i> Iniciar sua Primeira Conex√£o
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Conex√£o Lan√ßada com Sucesso! üöÄ</h3>
                <button class="close-modal" id="closeSuccessModal">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; padding: 20px 0;">
                    <div style="font-size: 5rem; color: var(--secondary); margin-bottom: 20px;">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3 style="margin-bottom: 16px;">Sua conex√£o est√° ativa no galaxy!</h3>
                    <p style="color: var(--gray); margin-bottom: 24px; line-height: 1.6;">
                        Agora outras pessoas podem ver sua proposta e conectar com voc√™ atrav√©s do globo interativo.
                    </p>
                    
                    <div class="code-display" id="generatedCode">SYNTA-5A8B3C</div>
                    <p class="form-hint" style="text-align: center; margin-bottom: 24px; max-width: 400px; margin-left: auto; margin-right: auto;">
                        <i class="fas fa-exclamation-triangle" style="color: var(--accent-alt);"></i>
                        Este √© seu c√≥digo de acesso galaxy. Guarde-o com seguran√ßa para gerenciar esta conex√£o!
                    </p>
                    
                    <div style="display: flex; gap: 12px; margin-top: 24px;">
                        <button class="btn btn-primary" id="copyCodeBtn" style="flex: 1;">
                            <i class="fas fa-copy"></i> Copiar C√≥digo
                        </button>
                        <button class="btn btn-outline" id="goToDashboardBtn" style="flex: 1;">
                            <i class="fas fa-tachometer-alt"></i> Painel Galaxy
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Location Details Modal -->
    <div class="modal" id="locationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-map-marked-alt"></i> Detalhes da Localiza√ß√£o</h3>
                <button class="close-modal" id="closeLocationModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="locationModalContent">
                    <!-- Dynamic content will be loaded here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon">
            <i class="fas fa-check"></i>
        </div>
        <div>
            <div style="font-weight: 700;" id="notificationTitle">Conex√£o Estabelecida</div>
            <div style="font-size: 0.95rem; color: var(--gray);" id="notificationMessage">Sua a√ß√£o foi realizada com sucesso no galaxy</div>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div class="modal" id="loadingModal" style="display: flex;">
        <div class="modal-content" style="max-width: 300px; text-align: center;">
            <div class="modal-body">
                <div class="loading">
                    <div class="spinner"></div>
                    <h3 style="margin-bottom: 10px; color: white;">Inicializando Galaxy</h3>
                    <p style="color: var(--gray);">Carregando conex√µes globais...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state with enhanced functionality
        let state = {
            user: null,
            userCode: null,
            posts: [],
            currentLocation: null,
            globe: null,
            autoRotate: true,
            panelOpen: true,
            currentView: 'posts',
            selectedLocation: null,
            markers: [],
            connections: [],
            nightMode: false,
            geocoder: null,
            userLocation: null
        };
        
        // Enhanced sample data with real coordinates
        const samplePosts = [
            {
                id: 1,
                title: "Procuro parceiro para startup de sustentabilidade",
                description: "Busco algu√©m com experi√™ncia em tecnologia verde para desenvolver uma plataforma de rastreamento de carbono para empresas.",
                category: "business",
                location: "S√£o Paulo, Brasil",
                city: "S√£o Paulo",
                country: "Brasil",
                coordinates: { lat: -23.5505, lng: -46.6333 },
                time: "2 horas atr√°s",
                userCode: "SYNTA-123ABC",
                emailVisible: false,
                active: true,
                points: 1200,
                privacy: "public"
            },
            {
                id: 2,
                title: "Quero formar um grupo de estudos de franc√™s",
                description: "Estou estudando franc√™s e gostaria de criar um grupo semanal para praticar conversa√ß√£o. Iniciantes s√£o bem-vindos!",
                category: "friendship",
                location: "Paris, Fran√ßa",
                city: "Paris",
                country: "Fran√ßa",
                coordinates: { lat: 48.8566, lng: 2.3522 },
                time: "5 horas atr√°s",
                userCode: "SYNTA-456DEF",
                emailVisible: true,
                active: true,
                points: 800,
                privacy: "public"
            },
            {
                id: 3,
                title: "Ofere√ßo servi√ßos de design gr√°fico premium",
                description: "Designer com 5 anos de experi√™ncia, especializado em identidade visual e UI/UX. Pre√ßos acess√≠veis para pequenos neg√≥cios.",
                category: "services",
                location: "Nova Iorque, EUA",
                city: "Nova Iorque",
                country: "Estados Unidos",
                coordinates: { lat: 40.7128, lng: -74.0060 },
                time: "1 dia atr√°s",
                userCode: "SYNTA-789GHI",
                emailVisible: false,
                active: true,
                points: 2000,
                privacy: "public"
            },
            {
                id: 4,
                title: "Organizando evento de networking para desenvolvedores",
                description: "Vamos nos encontrar no pr√≥ximo s√°bado para trocar experi√™ncias e fazer networking na √°rea de tecnologia.",
                category: "events",
                location: "Berlim, Alemanha",
                city: "Berlim",
                country: "Alemanha",
                coordinates: { lat: 52.5200, lng: 13.4050 },
                time: "2 dias atr√°s",
                userCode: "SYNTA-012JKL",
                emailVisible: true,
                active: true,
                points: 1500,
                privacy: "public"
            },
            {
                id: 5,
                title: "Procurando co-founder para app de fitness inteligente",
                description: "Tenho a ideia e prot√≥tipo de um app de treinos personalizados com IA. Busco algu√©m com skills em marketing digital.",
                category: "business",
                location: "Toronto, Canad√°",
                city: "Toronto",
                country: "Canad√°",
                coordinates: { lat: 43.6532, lng: -79.3832 },
                time: "3 dias atr√°s",
                userCode: "SYNTA-345MNO",
                emailVisible: false,
                active: true,
                points: 3000,
                privacy: "private"
            },
            {
                id: 6,
                title: "Quero aprender a tocar viol√£o, algu√©m para ensinar?",
                description: "Sou iniciante completo e gostaria de trocar aulas por algo que eu possa oferecer (cozinhar, ajudar com tarefas, etc).",
                category: "learning",
                location: "Rio de Janeiro, Brasil",
                city: "Rio de Janeiro",
                country: "Brasil",
                coordinates: { lat: -22.9068, lng: -43.1729 },
                time: "4 dias atr√°s",
                userCode: "SYNTA-678PQR",
                emailVisible: true,
                active: true,
                points: 600,
                privacy: "public"
            },
            {
                id: 7,
                title: "Preciso de ajuda com projeto de jardinagem urbana",
                description: "Tenho um quintal pequeno e gostaria de transformar em uma horta sustent√°vel. Busco algu√©m com experi√™ncia em jardinagem.",
                category: "services",
                location: "Lisboa, Portugal",
                city: "Lisboa",
                country: "Portugal",
                coordinates: { lat: 38.7223, lng: -9.1393 },
                time: "5 dias atr√°s",
                userCode: "SYNTA-901STU",
                emailVisible: false,
                active: true,
                points: 900,
                privacy: "public"
            },
            {
                id: 8,
                title: "Grupo para hiking nas montanhas - todos os n√≠veis",
                description: "Organizando grupo para hiking nos fins de semana. Todos os n√≠veis s√£o bem-vindos! Encontros mensais.",
                category: "events",
                location: "Denver, EUA",
                city: "Denver",
                country: "Estados Unidos",
                coordinates: { lat: 39.7392, lng: -104.9903 },
                time: "1 semana atr√°s",
                userCode: "SYNTA-234VWX",
                emailVisible: true,
                active: true,
                points: 1100,
                privacy: "public"
            },
            {
                id: 9,
                title: "Colabora√ß√£o para podcast sobre tecnologia",
                description: "Busco co-host para podcast semanal sobre inova√ß√µes tecnol√≥gicas. Equipamento profissional dispon√≠vel.",
                category: "collab",
                location: "Londres, Reino Unido",
                city: "Londres",
                country: "Reino Unido",
                coordinates: { lat: 51.5074, lng: -0.1278 },
                time: "2 dias atr√°s",
                userCode: "SYNTA-567YZA",
                emailVisible: false,
                active: true,
                points: 1800,
                privacy: "private"
            },
            {
                id: 10,
                title: "Mentoria em desenvolvimento web para iniciantes",
                description: "Desenvolvedor s√™nior oferecendo mentoria gratuita para quem est√° come√ßando na √°rea. 1 hora por semana.",
                category: "learning",
                location: "T√≥quio, Jap√£o",
                city: "T√≥quio",
                country: "Jap√£o",
                coordinates: { lat: 35.6762, lng: 139.6503 },
                time: "3 dias atr√°s",
                userCode: "SYNTA-890BCD",
                emailVisible: true,
                active: true,
                points: 2500,
                privacy: "public"
            }
        ];
        
        // Enhanced user data
        const userData = {
            "SYNTA-5A8B3C": {
                name: "Viajante Galaxy",
                email: "conexao@galaxy.com",
                avatar: "VG",
                level: 3,
                points: 1200,
                joined: "2024-01-15",
                posts: [1, 5, 8],
                connections: 12,
                messages: [
                    { id: 1, from: "Maria P.", avatar: "MP", subject: "Interesse no seu post", preview: "Ol√°! Gostei da sua proposta e gostaria de conversar mais sobre a parceria...", time: "2 horas atr√°s", read: false },
                    { id: 2, from: "Carlos R.", avatar: "CR", subject: "Parceria para startup sustent√°vel", preview: "Tenho 8 anos de experi√™ncia com tecnologia sustent√°vel e adoraria colaborar...", time: "1 dia atr√°s", read: false },
                    { id: 3, from: "Ana L.", avatar: "AL", subject: "Sobre o grupo de hiking", preview: "Oi! Vi seu post sobre hiking e gostaria de mais informa√ß√µes sobre os pr√≥ximos encontros...", time: "2 dias atr√°s", read: true },
                    { id: 4, from: "Tech Labs", avatar: "TL", subject: "Oportunidade de investimento", preview: "Analisamos sua startup e temos interesse em investir. Podemos marcar uma call?", time: "3 dias atr√°s", read: true }
                ],
                proposals: [
                    { id: 1, postId: 1, from: "Roberto S.", message: "Tenho 8 anos de experi√™ncia em cria√ß√£o de conte√∫do sustent√°vel...", status: "pending" },
                    { id: 2, postId: 5, from: "Juliana M.", message: "Adoraria participar! Tenho experi√™ncia em marketing digital para apps de fitness...", status: "pending" }
                ]
            }
        };
        
        // Initialize the application
        async function init() {
            // Show loading
            document.getElementById('loadingModal').style.display = 'flex';
            
            // Initialize stars
            createStars();
            
            // Initialize Three.js globe with improved markers
            await initGlobe();
            
            // Load sample posts
            state.posts = [...samplePosts];
            
            // Initialize geocoder
            initGeocoder();
            
            // Try to get user location
            getUserLocation();
            
            // Setup event listeners
            setupEventListeners();
            
            // Render initial posts
            renderPosts();
            
            // Check if user is already logged in
            const savedCode = localStorage.getItem('syntaxUserCode');
            if (savedCode && userData[savedCode]) {
                loginWithCode(savedCode);
            }
            
            // Update total posts count
            updateTotalPostsCount();
            
            // Start animation
            animate();
            
            // Hide loading after 1.5 seconds
            setTimeout(() => {
                document.getElementById('loadingModal').style.display = 'none';
            }, 1500);
        }
        
        // Create animated stars
        function createStars() {
            const starsContainer = document.getElementById('starsContainer');
            const starCount = 200;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                // Random position
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                
                // Random size
                const size = Math.random() * 3 + 1;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                
                // Random opacity and animation
                star.style.opacity = Math.random() * 0.7 + 0.3;
                star.style.animationDuration = `${Math.random() * 3 + 2}s`;
                star.style.animationDelay = `${Math.random() * 2}s`;
                
                starsContainer.appendChild(star);
            }
        }
        
        // Initialize Three.js globe with fixed markers
        async function initGlobe() {
            return new Promise((resolve) => {
                const canvas = document.getElementById('globeCanvas');
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer({ 
                    canvas, 
                    antialias: true, 
                    alpha: true,
                    powerPreference: "high-performance"
                });
                
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                
                // Create Earth sphere with enhanced texture
                const geometry = new THREE.SphereGeometry(5, 128, 128);
                
                // Load Earth textures
                const textureLoader = new THREE.TextureLoader();
                const earthTexture = textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth_atmos_4096.jpg');
                const earthBump = textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth_normal_2048.jpg');
                const earthSpec = textureLoader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth_specular_2048.jpg');
                
                const material = new THREE.MeshPhongMaterial({
                    map: earthTexture,
                    bumpMap: earthBump,
                    bumpScale: 0.1,
                    specularMap: earthSpec,
                    specular: new THREE.Color(0x333333),
                    shininess: 10
                });
                
                const earth = new THREE.Mesh(geometry, material);
                scene.add(earth);
                
                // Add enhanced atmosphere with galaxy colors
                const atmosphereGeometry = new THREE.SphereGeometry(5.15, 128, 128);
                const atmosphereMaterial = new THREE.ShaderMaterial({
                    uniforms: {
                        glowColor: { value: new THREE.Color(0x8b5cf6) },
                        viewVector: { value: camera.position }
                    },
                    vertexShader: `
                        uniform vec3 viewVector;
                        varying float intensity;
                        void main() {
                            vec3 vNormal = normalize(normalMatrix * normal);
                            vec3 vNormel = normalize(normalMatrix * viewVector);
                            intensity = pow(0.7 - dot(vNormal, vNormel), 2.0);
                            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                        }
                    `,
                    fragmentShader: `
                        uniform vec3 glowColor;
                        varying float intensity;
                        void main() {
                            vec3 glow = glowColor * intensity;
                            gl_FragColor = vec4(glow, intensity * 0.3);
                        }
                    `,
                    side: THREE.BackSide,
                    blending: THREE.AdditiveBlending,
                    transparent: true
                });
                
                const atmosphere = new THREE.Mesh(atmosphereGeometry, atmosphereMaterial);
                earth.add(atmosphere);
                
                // Add galaxy particles
                const particlesGeometry = new THREE.BufferGeometry();
                const particlesCount = 5000;
                const posArray = new Float32Array(particlesCount * 3);
                
                for(let i = 0; i < particlesCount * 3; i++) {
                    posArray[i] = (Math.random() - 0.5) * 50;
                }
                
                particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
                
                const particlesMaterial = new THREE.PointsMaterial({
                    size: 0.02,
                    color: 0xa855f7,
                    transparent: true,
                    opacity: 0.6
                });
                
                const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
                scene.add(particlesMesh);
                
                // Add enhanced lights
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
                directionalLight.position.set(5, 3, 5);
                scene.add(directionalLight);
                
                const pointLight = new THREE.PointLight(0xa855f7, 0.5, 100);
                pointLight.position.set(10, 10, 10);
                scene.add(pointLight);
                
                // Position camera
                camera.position.z = 15;
                
                // Add orbit controls
                const controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true;
                controls.dampingFactor = 0.05;
                controls.rotateSpeed = 0.5;
                controls.minDistance = 8;
                controls.maxDistance = 30;
                controls.enablePan = false;
                
                // Create marker group attached to earth
                const markerGroup = new THREE.Group();
                earth.add(markerGroup);
                state.markerGroup = markerGroup;
                
                // Add post markers with improved positioning
                samplePosts.forEach(post => {
                    addMarkerToGlobe(post, markerGroup);
                });
                
                // Handle marker clicks
                const raycaster = new THREE.Raycaster();
                const mouse = new THREE.Vector2();
                
                function onCanvasClick(event) {
                    const rect = canvas.getBoundingClientRect();
                    mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                    mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
                    
                    raycaster.setFromCamera(mouse, camera);
                    
                    // Check intersection with markers
                    const intersects = raycaster.intersectObjects(markerGroup.children, true);
                    
                    if (intersects.length > 0) {
                        const marker = intersects[0].object;
                        const post = marker.userData.post;
                        
                        // Show post details
                        showLocationInfo(post);
                        state.selectedLocation = post.location;
                        
                        // Filter posts by location
                        filterPostsByLocation(post.location);
                        
                        // Highlight marker
                        highlightMarker(marker);
                        
                        // Show location details modal
                        showLocationModal(post);
                    } else {
                        // Clicked on empty space
                        hideLocationInfo();
                        state.selectedLocation = null;
                        renderPosts();
                    }
                }
                
                canvas.addEventListener('click', onCanvasClick);
                
                // Handle window resize
                function onWindowResize() {
                    camera.aspect = canvas.clientWidth / canvas.clientHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                }
                
                window.addEventListener('resize', onWindowResize);
                
                // Store globe objects in state
                state.globe = {
                    scene,
                    camera,
                    renderer,
                    earth,
                    controls,
                    particlesMesh,
                    animate: () => {
                        requestAnimationFrame(state.globe.animate);
                        
                        if (state.autoRotate) {
                            earth.rotation.y += 0.001;
                        }
                        
                        // Rotate particles slowly
                        particlesMesh.rotation.y += 0.0001;
                        
                        controls.update();
                        renderer.render(scene, camera);
                    }
                };
                
                // Initialize globe controls
                initGlobeControls();
                
                resolve();
            });
        }
        
        // Add marker to globe with proper positioning
        function addMarkerToGlobe(post, markerGroup) {
            const lat = post.coordinates.lat * Math.PI / 180;
            const lng = post.coordinates.lng * Math.PI / 180;
            const radius = 5.05;
            
            // Convert spherical coordinates to Cartesian
            const x = radius * Math.cos(lat) * Math.cos(lng);
            const y = radius * Math.sin(lat);
            const z = radius * Math.cos(lat) * Math.sin(lng);
            
            // Create marker with glow effect
            const markerGeometry = new THREE.SphereGeometry(0.08, 16, 16);
            const markerMaterial = new THREE.MeshBasicMaterial({ 
                color: getCategoryColor(post.category),
                transparent: true,
                opacity: 0.9
            });
            
            const marker = new THREE.Mesh(markerGeometry, markerMaterial);
            marker.position.set(x, y, z);
            
            // Create glow ring
            const ringGeometry = new THREE.RingGeometry(0.1, 0.15, 32);
            const ringMaterial = new THREE.MeshBasicMaterial({ 
                color: getCategoryColor(post.category),
                side: THREE.DoubleSide,
                transparent: true,
                opacity: 0.5
            });
            const ring = new THREE.Mesh(ringGeometry, ringMaterial);
            ring.position.set(x, y, z);
            
            // Align ring to face camera
            const normal = new THREE.Vector3(x, y, z).normalize();
            ring.lookAt(normal.multiplyScalar(2));
            
            // Add pulsing animation
            marker.userData = { 
                post, 
                type: 'post',
                pulseDirection: 1,
                pulseSpeed: 0.02
            };
            
            // Add to group
            markerGroup.add(marker);
            markerGroup.add(ring);
            
            // Store reference
            state.markers.push({ marker, ring, post });
        }
        
        // Highlight a marker
        function highlightMarker(marker) {
            // Reset all markers
            state.markers.forEach(m => {
                m.marker.scale.set(1, 1, 1);
                m.marker.material.opacity = 0.9;
                if (m.ring) m.ring.material.opacity = 0.5;
            });
            
            // Highlight selected marker
            marker.scale.set(1.5, 1.5, 1.5);
            marker.material.opacity = 1;
            
            // Find and highlight corresponding ring
            const markerData = state.markers.find(m => m.marker === marker);
            if (markerData && markerData.ring) {
                markerData.ring.material.opacity = 0.8;
                markerData.ring.scale.set(1.2, 1.2, 1.2);
            }
        }
        
        // Initialize geocoder for location autocomplete
        function initGeocoder() {
            // Initialize Geoapify autocomplete
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'geoapify-autocomplete-input';
            input.placeholder = 'Digite uma cidade, estado ou pa√≠s...';
            input.id = 'geoapify-autocomplete';
            
            const container = document.getElementById('locationAutocomplete');
            container.innerHTML = '';
            container.appendChild(input);
            
            // Initialize autocomplete
            const autocomplete = new GeoapifyAutocomplete(input, {
                type: 'city',
                lang: 'pt',
                filterByCountryCode: ['br', 'us', 'pt', 'fr', 'de', 'jp', 'ca', 'gb'],
                placeType: ['city', 'town', 'village', 'municipality']
            });
            
            // Handle selection
            autocomplete.on('select', (location) => {
                if (location) {
                    document.getElementById('postLat').value = location.properties.lat;
                    document.getElementById('postLng').value = location.properties.lon;
                    document.getElementById('postCity').value = location.properties.city || location.properties.name;
                    document.getElementById('postCountry').value = location.properties.country;
                    
                    // Update the hidden location field
                    const locationText = `${location.properties.city || location.properties.name}, ${location.properties.country}`;
                    document.getElementById('postLocation').value = locationText;
                    
                    showNotification('Localiza√ß√£o confirmada', `${locationText} foi selecionado com precis√£o.`);
                }
            });
            
            // Also add a regular input for fallback
            const fallbackInput = document.createElement('input');
            fallbackInput.type = 'text';
            fallbackInput.className = 'form-control';
            fallbackInput.id = 'postLocation';
            fallbackInput.placeholder = 'Ou digite manualmente (cidade, pa√≠s)';
            fallbackInput.style.marginTop = '10px';
            container.appendChild(fallbackInput);
        }
        
        // Get user location
        function getUserLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        state.userLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        
                        // Reverse geocode to get city name
                        reverseGeocode(position.coords.latitude, position.coords.longitude);
                    },
                    (error) => {
                        console.log('Geolocation error:', error);
                        // Default to S√£o Paulo
                        state.userLocation = { lat: -23.5505, lng: -46.6333 };
                    }
                );
            }
        }
        
        // Reverse geocode coordinates to get location name
        function reverseGeocode(lat, lng) {
            const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&accept-language=pt`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.address) {
                        const city = data.address.city || data.address.town || data.address.village;
                        const country = data.address.country;
                        if (city && country) {
                            state.userLocationName = `${city}, ${country}`;
                        }
                    }
                })
                .catch(console.error);
        }
        
        // Get color for category with galaxy theme
        function getCategoryColor(category) {
            const colors = {
                'friendship': 0x10b981,    // emerald
                'business': 0x8b5cf6,      // violet
                'services': 0xf59e0b,      // amber
                'events': 0xef4444,        // red
                'ideas': 0x3b82f6,         // blue
                'learning': 0x06b6d4,      // cyan
                'collab': 0xec4899         // pink
            };
            return colors[category] || 0x8b5cf6; // default purple
        }
        
        // Get category icon
        function getCategoryIcon(category) {
            const icons = {
                'friendship': 'üë•',
                'business': 'üíº',
                'services': 'üîß',
                'events': 'üéâ',
                'ideas': 'üí°',
                'learning': 'üìö',
                'collab': 'ü§ù'
            };
            return icons[category] || 'üåå';
        }
        
        // Get category name
        function getCategoryName(category) {
            const names = {
                'friendship': 'Amizade',
                'business': 'Neg√≥cios',
                'services': 'Servi√ßos',
                'events': 'Eventos',
                'ideas': 'Ideias',
                'learning': 'Aprendizado',
                'collab': 'Colabora√ß√£o'
            };
            return names[category] || 'Geral';
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Panel toggle
            document.getElementById('panelToggle').addEventListener('click', togglePanel);
            document.getElementById('panelClose').addEventListener('click', () => {
                state.panelOpen = false;
                updatePanelState();
            });
            
            // Create post button
            document.getElementById('createPostBtn').addEventListener('click', showCreatePostView);
            document.getElementById('newPostFromDashboard').addEventListener('click', showCreatePostView);
            
            // Access account button
            document.getElementById('accessAccountBtn').addEventListener('click', showAccessModal);
            
            // Cancel post button
            document.getElementById('cancelPostBtn').addEventListener('click', showPostsView);
            
            // Post form submission
            document.getElementById('postForm').addEventListener('submit', handlePostSubmit);
            
            // Access modal
            document.getElementById('closeAccessModal').addEventListener('click', () => {
                document.getElementById('accessModal').classList.remove('active');
            });
            
            document.getElementById('submitAccessCode').addEventListener('click', handleAccessCode);
            document.getElementById('createFirstPost').addEventListener('click', () => {
                document.getElementById('accessModal').classList.remove('active');
                showCreatePostView();
            });
            
            // Success modal
            document.getElementById('closeSuccessModal').addEventListener('click', () => {
                document.getElementById('successModal').classList.remove('active');
            });
            
            document.getElementById('copyCodeBtn').addEventListener('click', copyCodeToClipboard);
            document.getElementById('goToDashboardBtn').addEventListener('click', goToDashboard);
            
            // Logout button
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            
            // Edit profile button
            document.getElementById('editProfileBtn').addEventListener('click', () => {
                showNotification('Editar Perfil', 'Personalize seu perfil galaxy em breve!');
            });
            
            // View stats button
            document.getElementById('viewStatsBtn').addEventListener('click', () => {
                showNotification('Estat√≠sticas', 'Suas estat√≠sticas galaxy ser√£o exibidas em breve!');
            });
            
            // View all messages button
            document.getElementById('viewAllMessages').addEventListener('click', () => {
                showNotification('Centro de Mensagens', 'Acesse todas suas mensagens galaxy em breve!');
            });
            
            // Character count for post description
            document.getElementById('postDescription').addEventListener('input', updateCharCount);
            
            // Search and filter
            document.getElementById('categoryFilter').addEventListener('change', renderPosts);
            document.getElementById('searchFilter').addEventListener('input', renderPosts);
            document.getElementById('locationFilter').addEventListener('input', renderPosts);
            
            // Location modal
            document.getElementById('closeLocationModal').addEventListener('click', () => {
                document.getElementById('locationModal').classList.remove('active');
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', (e) => {
                const modals = ['accessModal', 'successModal', 'locationModal'];
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    if (e.target === modal) modal.classList.remove('active');
                });
            });
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                // ESC to close modals
                if (e.key === 'Escape') {
                    document.getElementById('accessModal').classList.remove('active');
                    document.getElementById('successModal').classList.remove('active');
                    document.getElementById('locationModal').classList.remove('active');
                }
                
                // Ctrl/Cmd + K to search
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('searchFilter').focus();
                }
            });
        }
        
        // Initialize globe controls
        function initGlobeControls() {
            document.getElementById('zoomInBtn').addEventListener('click', () => {
                state.globe.camera.position.z = Math.max(state.globe.camera.position.z - 1, 8);
            });
            
            document.getElementById('zoomOutBtn').addEventListener('click', () => {
                state.globe.camera.position.z = Math.min(state.globe.camera.position.z + 1, 30);
            });
            
            document.getElementById('resetViewBtn').addEventListener('click', () => {
                state.globe.camera.position.set(0, 0, 15);
                state.globe.controls.reset();
            });
            
            document.getElementById('autoRotateBtn').addEventListener('click', () => {
                state.autoRotate = !state.autoRotate;
                const btn = document.getElementById('autoRotateBtn');
                if (state.autoRotate) {
                    btn.classList.add('active');
                    btn.innerHTML = '<i class="fas fa-sync-alt"></i>';
                } else {
                    btn.classList.remove('active');
                    btn.innerHTML = '<i class="fas fa-pause"></i>';
                }
            });
            
            document.getElementById('nightModeBtn').addEventListener('click', () => {
                state.nightMode = !state.nightMode;
                const btn = document.getElementById('nightModeBtn');
                if (state.nightMode) {
                    btn.classList.add('active');
                    btn.innerHTML = '<i class="fas fa-sun"></i>';
                    // Apply night mode to earth
                    state.globe.earth.material.color.setHex(0x333333);
                } else {
                    btn.classList.remove('active');
                    btn.innerHTML = '<i class="fas fa-moon"></i>';
                    // Restore normal colors
                    state.globe.earth.material.color.setHex(0xffffff);
                }
            });
        }
        
        // Toggle panel visibility
        function togglePanel() {
            state.panelOpen = !state.panelOpen;
            updatePanelState();
        }
        
        // Update panel state
        function updatePanelState() {
            const panel = document.getElementById('sidePanel');
            const toggleBtn = document.getElementById('panelToggle');
            
            if (state.panelOpen) {
                panel.classList.remove('collapsed');
                toggleBtn.classList.remove('collapsed');
                toggleBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
            } else {
                panel.classList.add('collapsed');
                toggleBtn.classList.add('collapsed');
                toggleBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
            }
        }
        
        // Show posts view
        function showPostsView() {
            state.currentView = 'posts';
            updateView();
            renderPosts();
        }
        
        // Show dashboard view
        function showDashboardView() {
            state.currentView = 'dashboard';
            updateView();
            renderDashboard();
        }
        
        // Show create post view
        function showCreatePostView() {
            state.currentView = 'createPost';
            updateView();
            
            // Pre-fill location if available
            if (state.userLocationName) {
                document.getElementById('postLocation').value = state.userLocationName;
            }
        }
        
        // Update current view
        function updateView() {
            // Hide all views
            document.getElementById('postsView').style.display = 'none';
            document.getElementById('dashboardView').style.display = 'none';
            document.getElementById('createPostView').style.display = 'none';
            
            // Update panel title
            const panelTitle = document.getElementById('panelTitle');
            
            // Show current view
            switch(state.currentView) {
                case 'posts':
                    document.getElementById('postsView').style.display = 'block';
                    panelTitle.textContent = 'üåå Explorar Conex√µes';
                    break;
                case 'dashboard':
                    document.getElementById('dashboardView').style.display = 'block';
                    panelTitle.textContent = 'üöÄ Minha Gal√°xia';
                    break;
                case 'createPost':
                    document.getElementById('createPostView').style.display = 'block';
                    panelTitle.textContent = '‚ú® Nova Conex√£o';
                    break;
            }
            
            // Open panel if closed
            if (!state.panelOpen) {
                state.panelOpen = true;
                updatePanelState();
            }
        }
        
        // Render posts to the list
        function renderPosts() {
            const postsList = document.getElementById('postsList');
            const categoryFilter = document.getElementById('categoryFilter').value;
            const searchFilter = document.getElementById('searchFilter').value.toLowerCase();
            const locationFilter = document.getElementById('locationFilter').value.toLowerCase();
            
            // Filter posts
            let filteredPosts = state.posts.filter(post => post.active);
            
            if (categoryFilter !== 'all') {
                filteredPosts = filteredPosts.filter(post => post.category === categoryFilter);
            }
            
            if (searchFilter) {
                filteredPosts = filteredPosts.filter(post => 
                    post.title.toLowerCase().includes(searchFilter) || 
                    post.description.toLowerCase().includes(searchFilter)
                );
            }
            
            if (locationFilter) {
                filteredPosts = filteredPosts.filter(post => 
                    post.location.toLowerCase().includes(locationFilter) ||
                    post.city.toLowerCase().includes(locationFilter) ||
                    post.country.toLowerCase().includes(locationFilter)
                );
            }
            
            // Filter by selected location if any
            if (state.selectedLocation) {
                filteredPosts = filteredPosts.filter(post => post.location === state.selectedLocation);
            }
            
            // Clear list
            postsList.innerHTML = '';
            
            if (filteredPosts.length === 0) {
                postsList.innerHTML = `
                    <div class="loading">
                        <div style="font-size: 4rem; color: var(--primary-light); margin-bottom: 16px;">
                            <i class="fas fa-globe-americas"></i>
                        </div>
                        <h3 style="margin-bottom: 8px; color: white;">Nenhuma conex√£o encontrada</h3>
                        <p style="color: var(--gray); text-align: center;">
                            Tente ajustar os filtros ou selecione outra localiza√ß√£o no globo galaxy
                        </p>
                        <button class="btn btn-outline btn-small" id="exploreAllBtn" style="margin-top: 20px;">
                            <i class="fas fa-compass"></i> Explorar Todas as Conex√µes
                        </button>
                    </div>
                `;
                
                // Add event listener to explore all button
                document.getElementById('exploreAllBtn')?.addEventListener('click', () => {
                    document.getElementById('categoryFilter').value = 'all';
                    document.getElementById('searchFilter').value = '';
                    document.getElementById('locationFilter').value = '';
                    state.selectedLocation = null;
                    renderPosts();
                });
                
                return;
            }
            
            // Render posts
            filteredPosts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.className = 'post-card';
                
                postElement.innerHTML = `
                    <div class="post-header">
                        <div class="post-category">${getCategoryIcon(post.category)} ${getCategoryName(post.category)}</div>
                        <div class="post-time">${post.time}</div>
                    </div>
                    <h4 class="post-title">${post.title}</h4>
                    <p class="post-description">${post.description}</p>
                    <div class="post-footer">
                        <div class="post-location">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${post.location}</span>
                            ${post.privacy === 'private' ? '<i class="fas fa-lock" style="margin-left: 5px; color: var(--accent-alt);"></i>' : ''}
                        </div>
                        <div class="post-actions">
                            <button class="btn btn-outline btn-small contact-btn" data-id="${post.id}">
                                <i class="fas fa-envelope"></i> Conectar
                            </button>
                            <button class="btn btn-outline btn-small view-btn" data-id="${post.id}">
                                <i class="fas fa-eye"></i> Ver
                            </button>
                        </div>
                    </div>
                    <div style="margin-top: 12px; display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 0.85rem; color: var(--accent);">
                            <i class="fas fa-gem"></i> ${post.points.toLocaleString()} pontos
                        </span>
                        <span style="font-size: 0.85rem; color: var(--gray);">
                            <i class="fas fa-users"></i> ${Math.floor(Math.random() * 20) + 1} interessados
                        </span>
                    </div>
                `;
                
                postsList.appendChild(postElement);
            });
            
            // Add event listeners to buttons
            document.querySelectorAll('.contact-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const postId = parseInt(e.currentTarget.dataset.id);
                    const post = state.posts.find(p => p.id === postId);
                    
                    if (state.user) {
                        showNotification('Conex√£o Iniciada', `Voc√™ iniciou uma conex√£o sobre: "${post.title}"`);
                    } else {
                        showAccessModal();
                    }
                });
            });
            
            document.querySelectorAll('.view-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const postId = parseInt(e.currentTarget.dataset.id);
                    const post = state.posts.find(p => p.id === postId);
                    showLocationModal(post);
                });
            });
        }
        
        // Render dashboard
        function renderDashboard() {
            if (!state.user) return;
            
            const user = userData[state.userCode];
            
            // Update user info
            document.getElementById('userName').textContent = user.name;
            document.getElementById('userEmail').textContent = user.email;
            document.getElementById('userAvatar').textContent = user.avatar;
            document.getElementById('userCode').textContent = state.userCode;
            
            // Update counts
            document.getElementById('userPostsCount').textContent = user.posts.length;
            document.getElementById('userMessagesCount').textContent = user.messages.filter(m => !m.read).length;
            document.getElementById('userProposalsCount').textContent = user.proposals.length;
            document.getElementById('userResponsesCount').textContent = user.connections;
            
            // Render user posts
            const userPostsList = document.getElementById('userPostsList');
            userPostsList.innerHTML = '';
            
            user.posts.forEach(postId => {
                const post = state.posts.find(p => p.id === postId);
                if (!post) return;
                
                const postElement = document.createElement('div');
                postElement.className = 'post-card';
                
                postElement.innerHTML = `
                    <div class="post-header">
                        <div class="post-category">${getCategoryIcon(post.category)} ${getCategoryName(post.category)}</div>
                        <div class="post-time">${post.time}</div>
                    </div>
                    <h4 class="post-title">${post.title}</h4>
                    <p class="post-description">${post.description}</p>
                    <div class="post-footer">
                        <div class="post-location">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${post.location}</span>
                        </div>
                        <div class="post-actions">
                            <button class="btn btn-outline btn-small" data-id="${post.id}">
                                <i class="fas fa-chart-bar"></i> ${Math.floor(Math.random() * 5) + 1} propostas
                            </button>
                        </div>
                    </div>
                    <div style="margin-top: 12px;">
                        <span style="font-size: 0.85rem; color: var(--accent);">
                            <i class="fas fa-eye"></i> ${Math.floor(Math.random() * 100) + 50} visualiza√ß√µes
                        </span>
                    </div>
                `;
                
                userPostsList.appendChild(postElement);
            });
            
            // Render messages
            const userMessagesList = document.getElementById('userMessagesList');
            userMessagesList.innerHTML = '';
            
            user.messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = `message-item ${message.read ? '' : 'unread'}`;
                messageElement.innerHTML = `
                    <div class="message-avatar">${message.avatar}</div>
                    <div class="message-content">
                        <div class="message-sender">${message.from}</div>
                        <div class="message-preview">${message.preview}</div>
                        <div style="font-size: 0.85rem; color: var(--accent); margin-top: 4px;">
                            <i class="far fa-clock"></i> ${message.time}
                        </div>
                    </div>
                `;
                
                userMessagesList.appendChild(messageElement);
            });
        }
        
        // Handle post form submission
        async function handlePostSubmit(e) {
            e.preventDefault();
            
            // Get form values
            const title = document.getElementById('postTitle').value;
            const category = document.getElementById('postCategory').value;
            const description = document.getElementById('postDescription').value;
            const email = document.getElementById('postEmail').value;
            const duration = document.getElementById('postDuration').value;
            const privacy = document.querySelector('input[name="privacy"]:checked').value;
            
            // Get location data
            let location = document.getElementById('postLocation').value;
            let city = document.getElementById('postCity').value;
            let country = document.getElementById('postCountry').value;
            let lat = document.getElementById('postLat').value;
            let lng = document.getElementById('postLng').value;
            
            // If location not set via autocomplete, try to geocode
            if (!lat || !lng) {
                if (location) {
                    const coords = await geocodeLocation(location);
                    if (coords) {
                        lat = coords.lat;
                        lng = coords.lng;
                        
                        // Try to get city and country
                        const locationData = await reverseGeocodeForDetails(lat, lng);
                        if (locationData) {
                            city = locationData.city || location.split(',')[0];
                            country = locationData.country || location.split(',')[1]?.trim();
                        }
                    }
                }
            }
            
            // Fallback to user location or random
            if (!lat || !lng) {
                if (state.userLocation) {
                    lat = state.userLocation.lat;
                    lng = state.userLocation.lng;
                } else {
                    const randomCoords = getRandomCoordinates();
                    lat = randomCoords.lat;
                    lng = randomCoords.lng;
                }
            }
            
            // Generate a unique code for the user if they don't have one
            let userCode = state.userCode;
            if (!userCode) {
                userCode = generateUserCode();
                state.userCode = userCode;
                
                // Create a new user entry
                userData[userCode] = {
                    name: email.split('@')[0],
                    email: email,
                    avatar: email.substring(0, 2).toUpperCase(),
                    level: 1,
                    points: 1000,
                    joined: new Date().toISOString().split('T')[0],
                    posts: [],
                    connections: 0,
                    messages: [],
                    proposals: []
                };
                
                // Store in localStorage
                localStorage.setItem('syntaxUserCode', userCode);
            }
            
            // Create new post
            const newPost = {
                id: state.posts.length + 1,
                title,
                description,
                category,
                location: location || `${city}, ${country}`,
                city: city || 'N√£o especificado',
                country: country || 'N√£o especificado',
                coordinates: { lat: parseFloat(lat), lng: parseFloat(lng) },
                time: "Agora mesmo",
                userCode,
                emailVisible: false,
                active: true,
                points: parseInt(duration) * 200, // Points based on duration
                privacy
            };
            
            // Add to posts array
            state.posts.unshift(newPost);
            
            // Add marker to globe
            addMarkerToGlobe(newPost, state.markerGroup);
            
            // Add to user's posts
            if (userData[userCode]) {
                userData[userCode].posts.push(newPost.id);
                userData[userCode].points += 500; // Bonus points for new post
            }
            
            // Show success modal
            document.getElementById('generatedCode').textContent = userCode;
            document.getElementById('successModal').classList.add('active');
            
            // Reset form
            e.target.reset();
            updateCharCount();
            
            // Update counts
            updateTotalPostsCount();
            
            // Show notification
            showNotification('Conex√£o Lan√ßada! üöÄ', 'Sua conex√£o galaxy est√° ativa e vis√≠vel no globo!');
        }
        
        // Geocode location string to coordinates
        async function geocodeLocation(location) {
            const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(location)}&limit=1`;
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                
                if (data && data.length > 0) {
                    return {
                        lat: parseFloat(data[0].lat),
                        lng: parseFloat(data[0].lon)
                    };
                }
            } catch (error) {
                console.error('Geocoding error:', error);
            }
            
            return null;
        }
        
        // Reverse geocode for city/country details
        async function reverseGeocodeForDetails(lat, lng) {
            const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&accept-language=pt`;
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.address) {
                    return {
                        city: data.address.city || data.address.town || data.address.village,
                        country: data.address.country
                    };
                }
            } catch (error) {
                console.error('Reverse geocoding error:', error);
            }
            
            return null;
        }
        
        // Handle access code submission
        function handleAccessCode() {
            const code = document.getElementById('accessCode').value.trim().toUpperCase();
            
            if (!code || !code.startsWith('SYNTA-')) {
                showNotification('C√≥digo Inv√°lido', 'Por favor, insira um c√≥digo no formato SYNTA-XXXXXX');
                return;
            }
            
            if (userData[code]) {
                loginWithCode(code);
                document.getElementById('accessModal').classList.remove('active');
                document.getElementById('accessCode').value = '';
            } else {
                showNotification('C√≥digo N√£o Encontrado', 'Este c√≥digo n√£o est√° associado a nenhuma conta galaxy.');
            }
        }
        
        // Login with code
        function loginWithCode(code) {
            state.userCode = code;
            state.user = userData[code];
            localStorage.setItem('syntaxUserCode', code);
            
            // Update UI
            showDashboardView();
            
            // Show notification
            showNotification('Bem-vindo de volta! üöÄ', `Voc√™ acessou sua gal√°xia com o c√≥digo ${code}`);
        }
        
        // Handle logout
        function handleLogout() {
            state.userCode = null;
            state.user = null;
            localStorage.removeItem('syntaxUserCode');
            
            // Update UI
            showPostsView();
            
            // Show notification
            showNotification('At√© logo, Viajante!', 'Voc√™ saiu da sua gal√°xia. Volte sempre! ‚ú®');
        }
        
        // Show access modal
        function showAccessModal() {
            document.getElementById('accessModal').classList.add('active');
        }
        
        // Copy code to clipboard
        function copyCodeToClipboard() {
            const code = document.getElementById('generatedCode').textContent;
            navigator.clipboard.writeText(code)
                .then(() => {
                    showNotification('C√≥digo Copiado!', 'O c√≥digo galaxy foi copiado para sua √°rea de transfer√™ncia.');
                })
                .catch(err => {
                    console.error('Erro ao copiar c√≥digo: ', err);
                });
        }
        
        // Go to dashboard from success modal
        function goToDashboard() {
            document.getElementById('successModal').classList.remove('active');
            
            if (state.userCode) {
                loginWithCode(state.userCode);
            } else {
                showPostsView();
            }
        }
        
        // Show location info
        function showLocationInfo(post) {
            const locationInfo = document.getElementById('locationInfo');
            const locationName = document.getElementById('locationName');
            const locationPostsCount = document.getElementById('locationPostsCount');
            const locationDetails = document.getElementById('locationDetails');
            
            locationName.textContent = post.location;
            
            // Count posts in this location
            const postsInLocation = state.posts.filter(p => 
                (p.city === post.city && p.country === post.country) && p.active
            ).length;
            
            locationPostsCount.textContent = `${postsInLocation} ${postsInLocation === 1 ? 'conex√£o' : 'conex√µes'} nesta regi√£o`;
            
            locationDetails.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                    <i class="fas fa-layer-group" style="color: var(--accent);"></i>
                    <span>${getCategoryName(post.category)}</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-gem" style="color: var(--accent-alt);"></i>
                    <span>${post.points.toLocaleString()} pontos galaxy</span>
                </div>
            `;
            
            locationInfo.classList.add('active');
        }
        
        // Show location modal with details
        function showLocationModal(post) {
            const modalContent = document.getElementById('locationModalContent');
            
            modalContent.innerHTML = `
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 4rem; margin-bottom: 16px; color: ${getCategoryColor(post.category)};">
                        ${getCategoryIcon(post.category)}
                    </div>
                    <h3 style="margin-bottom: 8px; color: white;">${post.title}</h3>
                    <p style="color: var(--gray);">${post.location}</p>
                </div>
                
                <div style="background: rgba(30, 27, 75, 0.6); padding: 20px; border-radius: var(--radius); margin-bottom: 20px;">
                    <h4 style="margin-bottom: 12px; color: var(--accent);">
                        <i class="fas fa-align-left"></i> Descri√ß√£o
                    </h4>
                    <p style="color: white; line-height: 1.6;">${post.description}</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 24px;">
                    <div style="background: rgba(30, 27, 75, 0.6); padding: 15px; border-radius: var(--radius);">
                        <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 5px;">Categoria</div>
                        <div style="color: white; font-weight: 600;">${getCategoryName(post.category)}</div>
                    </div>
                    <div style="background: rgba(30, 27, 75, 0.6); padding: 15px; border-radius: var(--radius);">
                        <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 5px;">Status</div>
                        <div style="color: var(--accent); font-weight: 600;">Ativo ‚Ä¢ ${post.time}</div>
                    </div>
                    <div style="background: rgba(30, 27, 75, 0.6); padding: 15px; border-radius: var(--radius);">
                        <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 5px;">Pontos Galaxy</div>
                        <div style="color: var(--accent-alt); font-weight: 600;">
                            <i class="fas fa-gem"></i> ${post.points.toLocaleString()}
                        </div>
                    </div>
                    <div style="background: rgba(30, 27, 75, 0.6); padding: 15px; border-radius: var(--radius);">
                        <div style="font-size: 0.9rem; color: var(--gray); margin-bottom: 5px;">Privacidade</div>
                        <div style="color: white; font-weight: 600;">
                            ${post.privacy === 'public' ? 'üåç P√∫blica' : 'üîí Privada'}
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center;">
                    <button class="btn btn-primary" id="connectToPost" style="width: 100%;">
                        <i class="fas fa-handshake"></i> Conectar com ${post.city}
                    </button>
                </div>
            `;
            
            // Add event listener to connect button
            setTimeout(() => {
                document.getElementById('connectToPost')?.addEventListener('click', () => {
                    if (state.user) {
                        showNotification('Conex√£o Iniciada!', `Voc√™ se conectou com a proposta em ${post.location}`);
                        document.getElementById('locationModal').classList.remove('active');
                    } else {
                        showAccessModal();
                    }
                });
            }, 100);
            
            document.getElementById('locationModal').classList.add('active');
        }
        
        // Hide location info
        function hideLocationInfo() {
            document.getElementById('locationInfo').classList.remove('active');
        }
        
        // Filter posts by location
        function filterPostsByLocation(location) {
            state.selectedLocation = location;
            renderPosts();
        }
        
        // Update character count
        function updateCharCount() {
            const length = document.getElementById('postDescription').value.length;
            document.getElementById('charCount').textContent = `${length}/500 caracteres`;
            
            // Change color based on length
            const charCount = document.getElementById('charCount');
            if (length > 450) {
                charCount.style.color = 'var(--accent-alt)';
            } else if (length > 400) {
                charCount.style.color = 'var(--accent)';
            } else {
                charCount.style.color = 'var(--gray)';
            }
        }
        
        // Generate a user code
        function generateUserCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = 'SYNTA-';
            
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            return code;
        }
        
        // Get random coordinates
        function getRandomCoordinates() {
            const cities = [
                { lat: -23.5505, lng: -46.6333 }, // S√£o Paulo
                { lat: 40.7128, lng: -74.0060 }, // New York
                { lat: 51.5074, lng: -0.1278 }, // London
                { lat: 35.6762, lng: 139.6503 }, // Tokyo
                { lat: 48.8566, lng: 2.3522 }, // Paris
                { lat: 52.5200, lng: 13.4050 }, // Berlin
                { lat: 37.7749, lng: -122.4194 }, // San Francisco
                { lat: 19.4326, lng: -99.1332 }, // Mexico City
                { lat: 34.0522, lng: -118.2437 }, // Los Angeles
                { lat: 55.7558, lng: 37.6173 } // Moscow
            ];
            
            return cities[Math.floor(Math.random() * cities.length)];
        }
        
        // Update total posts count
        function updateTotalPostsCount() {
            const activePosts = state.posts.filter(post => post.active).length;
            document.getElementById('totalPosts').textContent = activePosts.toLocaleString();
        }
        
        // Show notification
        function showNotification(title, message) {
            const notification = document.getElementById('notification');
            const notificationTitle = document.getElementById('notificationTitle');
            const notificationMessage = document.getElementById('notificationMessage');
            
            notificationTitle.textContent = title;
            notificationMessage.textContent = message;
            
            notification.classList.add('active');
            
            setTimeout(() => {
                notification.classList.remove('active');
            }, 5000);
        }
        
        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            if (state.globe) {
                if (state.autoRotate) {
                    state.globe.earth.rotation.y += 0.001;
                }
                
                // Animate markers
                state.markers.forEach(markerData => {
                    if (markerData.marker && markerData.marker.userData) {
                        // Pulsing animation
                        const scale = markerData.marker.scale.x;
                        const direction = markerData.marker.userData.pulseDirection;
                        const speed = markerData.marker.userData.pulseSpeed;
                        
                        let newScale = scale + (direction * speed);
                        
                        if (newScale > 1.3) {
                            newScale = 1.3;
                            markerData.marker.userData.pulseDirection = -1;
                        } else if (newScale < 0.8) {
                            newScale = 0.8;
                            markerData.marker.userData.pulseDirection = 1;
                        }
                        
                        markerData.marker.scale.set(newScale, newScale, newScale);
                        
                        // Rotate rings
                        if (markerData.ring) {
                            markerData.ring.rotation.z += 0.01;
                        }
                    }
                });
                
                state.globe.controls.update();
                state.globe.renderer.render(state.globe.scene, state.globe.camera);
            }
        }
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
        
        // Handle beforeunload
        window.addEventListener('beforeunload', () => {
            if (state.userCode) {
                localStorage.setItem('syntaxUserCode', state.userCode);
            }
        });
    </script>
</body>
</html>